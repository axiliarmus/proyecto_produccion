{% extends 'admin_layout.html' %}

{% block title %}Usuarios{% endblock %}
{% block header_title %}Gestión de Usuarios{% endblock %}
{% block header_subtitle %}Administra los accesos y roles del sistema{% endblock %}

{% block content %}

<div class="d-flex justify-content-end mb-4">
  <a href="{{ url_for('usuarios_nuevo_form') }}" class="btn btn-accent d-flex align-items-center gap-2">
    <i class='bx bx-plus-circle'></i> Nuevo Usuario
  </a>
</div>

<div class="admin-card">
  <div class="table-responsive">
    <table class="table table-dark table-hover align-middle mb-0" style="background: transparent;">
      <thead>
        <tr>
          <th>Usuario</th>
          <th>Nombre</th>
          <th>Tipo</th>
          <th class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for u in usuarios %}
        <tr>
          <td class="fw-bold text-white">{{ u.usuario }}</td>
          <td>{{ u.nombre }}</td>
          <td>
            {% if u.tipo == 'administrador' %}
              <span class="badge bg-danger">Administrador</span>
            {% elif u.tipo == 'supervisor' %}
              <span class="badge bg-warning text-dark">Supervisor</span>
            {% elif u.tipo == 'soporte' %}
              <span class="badge bg-info text-dark">Soporte</span>
            {% else %}
              <span class="badge bg-secondary">Operador</span>
            {% endif %}
          </td>
          <td class="text-end">
            <a href="{{ url_for('usuarios_editar_form', id=u._id) }}" class="btn btn-ghost-warning d-inline-flex align-items-center gap-1">
              <i class='bx bx-edit-alt'></i> Editar
            </a>
            <form action="{{ url_for('usuarios_delete', id=u._id) }}" method="post" class="d-inline">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token }}">
              <button class="btn btn-ghost-danger d-inline-flex align-items-center gap-1" onclick="return confirm('¿Eliminar este usuario?')">
                <i class='bx bx-trash'></i> Eliminar
              </button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% if usuarios|length == 0 %}
    <div class="p-4 text-center text-secondary">No hay usuarios registrados aún.</div>
  {% endif %}
</div>

{% endblock %}