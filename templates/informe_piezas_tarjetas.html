{% extends 'base.html' %}
{% block title %}Resumen de Piezas por Cliente{% endblock %}

{% block content %}
<h2 class="mb-4 text-center">üì¶ Resumen de Piezas por Cliente</h2>

<div class="d-flex justify-content-between align-items-center mb-3">
  <p class="text-secondary mb-0">Tarjetas agrupadas por cliente, mostrando marco y tramos con el c√°lculo N - M = pendientes.</p>
  <a href="{{ url_for('admin_informes') }}" class="btn btn-secondary">‚Üê Volver a Informes</a>
</div>

{% for g in grupos %}
  <h4 class="mt-4 text-light">Cliente: {{ g.cliente }}</h4>
  <div class="row row-cols-1 row-cols-md-3 g-4">
    {% for m in g.marcos %}
    <div class="col">
      <div class="card bg-dark border-light shadow h-100 fixed-card">
        <div class="card-body d-flex flex-column">
          <div class="mb-3 text-center">
            <h5 class="card-title text-light mb-0">{{ m.marco }}</h5>
          </div>

          <div class="flex-grow-1">
            <table class="table table-dark table-sm mb-0 table-fixed">
              <colgroup>
                <col style="width: 55%">
                <col style="width: 45%">
              </colgroup>
              
              <tbody>
                {% for t in m.tramos %}
                <tr>
                  <td>{{ t.tramo }}</td>
                  <td class="num-col">{{ t.total }} - {{ t.rematadas }} = {{ t.pendientes }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
{% endfor %}

{% if grupos|length == 0 %}
  <div class="alert alert-secondary text-center">No hay datos de piezas.</div>
{% endif %}

{% endblock %}
